<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>NcmSplineFunc: NumCosmo Reference Manual</title>
<meta content="DocBook XSL Stylesheets Vsnapshot" name="generator"/>
<link href="index.html" rel="home" title="NumCosmo Reference Manual"/>
<link href="ch02s04.html" rel="up" title="Splines 1D"/>
<link href="NcmSplineRBF.html" rel="prev" title="NcmSplineRBF"/>
<link href="NcmSplineFuncTest.html" rel="next" title="NcmSplineFuncTest"/>
<meta content="GTK-Doc V1.34.0 (XML mode)" name="generator"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
<link href="container.css" rel="stylesheet" type="text/css"/><script type="text/x-mathjax-config">
//<![CDATA[
MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"],
linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], displayMath: [ ["$$","$$"], 
["\[", "\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
TeX: {  noUndefined: { 
    attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" 
    } },
equationNumbers: { autoNumber: "AMS" } },
messageStyle: "none"
});
//]]>
        </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script></head>
<body alink="#0000FF" bgcolor="white" link="#0000FF" text="black" vlink="#840084">
<table cellpadding="2" cellspacing="5" class="navigation" id="top" summary="Navigation header" width="100%"><tr valign="middle">
<td align="left" class="shortcuts" width="100%">
<a class="shortcut" href="#">Top</a><span id="nav_description">  <span class="dim">|</span> 
                  <a class="shortcut" href="#numcosmo-NcmSplineFunc.description">Description</a></span><span id="nav_hierarchy">  <span class="dim">|</span> 
                  <a class="shortcut" href="#numcosmo-NcmSplineFunc.object-hierarchy">Object Hierarchy</a></span>
</td>
<td><a accesskey="h" href="index.html"><img alt="Home" border="0" height="16" src="home.png" width="16"/></a></td>
<td><a accesskey="u" href="ch02s04.html"><img alt="Up" border="0" height="16" src="up.png" width="16"/></a></td>
<td><a accesskey="p" href="NcmSplineRBF.html"><img alt="Prev" border="0" height="16" src="left.png" width="16"/></a></td>
<td><a accesskey="n" href="NcmSplineFuncTest.html"><img alt="Next" border="0" height="16" src="right.png" width="16"/></a></td>
</tr></table>
<div class="refentry">
<a name="numcosmo-NcmSplineFunc"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="numcosmo-NcmSplineFunc.top_of_page"></a>NcmSplineFunc</span></h2>
<p>NcmSplineFunc — Automatic generation of the knots for a spline.</p>
</td>
<td align="right" class="gallery_image" valign="top"></td>
</tr></table></div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.stability-level"></a><h2>Stability Level</h2>
<acronym title="The intention of a Stable interface is to enable arbitrary third parties to
develop applications to these interfaces, release them, and have confidence that
they will run on all minor releases of the product (after the one in which the
interface was introduced, and within the same major release). Even at a major
release, incompatible changes are expected to be rare, and to have strong
justifications.
"><span class="acronym">Stable</span></acronym>, unless otherwise indicated
</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.functions"></a><h2>Functions</h2>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="functions_proto_type" width="150px"/>
<col class="functions_proto_name"/>
</colgroup>
<tbody>
<tr>
<td class="function_type">
<span class="returnvalue">gdouble</span>
</td>
<td class="function_name">
<span class="c_punctuation">(</span><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncF" title="NcmSplineFuncF ()">*NcmSplineFuncF</a><span class="c_punctuation">)</span> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="numcosmo-NcmSplineFunc.html#ncm-spline-set-func" title="ncm_spline_set_func ()">ncm_spline_set_func</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="numcosmo-NcmSplineFunc.html#ncm-spline-set-func-scale" title="ncm_spline_set_func_scale ()">ncm_spline_set_func_scale</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="numcosmo-NcmSplineFunc.html#ncm-spline-set-func1" title="ncm_spline_set_func1 ()">ncm_spline_set_func1</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="numcosmo-NcmSplineFunc.html#ncm-spline-set-func-grid1" title="ncm_spline_set_func_grid1 ()">ncm_spline_set_func_grid1</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="numcosmo-NcmSplineFunc.html#ncm-spline-set-func-grid" title="ncm_spline_set_func_grid ()">ncm_spline_set_func_grid</a> <span class="c_punctuation">()</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.other"></a><h2>Types and Values</h2>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="other_proto_type" width="150px"/>
<col class="other_proto_name"/>
</colgroup>
<tbody>
<tr>
<td class="datatype_keyword">enum</td>
<td class="function_name"><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType">NcmSplineFuncType</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a class="link" href="numcosmo-NcmSplineFunc.html#NCM-SPLINE-FUNC-DEFAULT-MAX-NODES:CAPS" title="NCM_SPLINE_FUNC_DEFAULT_MAX_NODES">NCM_SPLINE_FUNC_DEFAULT_MAX_NODES</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a class="link" href="numcosmo-NcmSplineFunc.html#NCM-SPLINE-KNOT-DIFF-TOL:CAPS" title="NCM_SPLINE_KNOT_DIFF_TOL">NCM_SPLINE_KNOT_DIFF_TOL</a></td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.object-hierarchy"></a><h2>Object Hierarchy</h2>
<pre class="screen">    <a href="/usr/share/gtk-doc/html/gobject/gobject-Enumeration-and-Flag-Types.html">GEnum</a>
    <span class="lineart">╰──</span> NcmSplineFuncType
</pre>
</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.includes"></a><h2>Includes</h2>
<pre class="synopsis">#include &lt;numcosmo/math/ncm_spline_func.h&gt;
</pre>
</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.description"></a><h2>Description</h2>
<p>This function implements 4 different methods to automatically determine
the <a class="link" href="NcmVector.html" title="NcmVector"><span class="type">NcmVector</span></a> of knots, $\mathbf{x}$, of a <a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a> given a relative error between the function $f$
to be interpolated and the spline result $\hat{f}$.</p>
<p>All available methods start with $n_0$ knots, $\mathbf{x}_0$, distributed  across [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
], including both limiting points.
The value of $n_0$ depends on the chosen interpolation method given by <em class="parameter"><code>s</code></em>
, e.g., <a class="link" href="NcmSplineCubicNotaknot.html" title="NcmSplineCubicNotaknot"><span class="type">NcmSplineCubicNotaknot</span></a> has $n_0 = 6$.</p>
<p>The function $f$ is first interpolated at the $\mathbf{x}_0$ knots, producing the interpolated function $\hat{f}_0$.
Next, the existing $n_0 - 1$ bins, $\Delta \mathbf{x}_0 = \mathbf{x}_0^{i+1} - \mathbf{x}_0^{i}$, are divided in half and
test points are placed at those positions, $\overline{\mathbf{x}}_0 = \frac{\mathbf{x}_0^{i+1} + \mathbf{x}_0^{i}}{2}$.
The following tests are done for each one of the bins $\Delta \mathbf{x}_0$ separately:
\begin{equation*}
  \left| \frac{ \hat{f}_0(\overline{\mathbf{x}}_0) - f(\overline{\mathbf{x}}_0)}{f(\overline{\mathbf{x}}_0)} \right| &lt; \mathrm{rel \_ error}
\end{equation*}
and
\begin{equation*}
  \left| \frac{ \int_{\Delta \mathbf{x}_0} \hat{f}_0  - \int_{\Delta \mathbf{x}_0} f }{ \int_{\Delta \mathbf{x}_0} f } \right| &lt; \mathrm{rel \_ error}.
\end{equation*}
Where $\int_{\Delta \mathbf{x}_0} f$ is the integral of the input function $f$ evaluated using <a class="ulink" href="https://en.wikipedia.org/wiki/Simpson%27s_rule" target="_top">Simpson's rule</a>
\begin{equation*}
\int_{\Delta \mathbf{x}_0} f = \frac{\Delta \mathbf{x}_0}{6} \left[ f \left( \mathbf{x}_0^{i} \right) + 4 f \left( \overline{\mathbf{x}}_0 \right) + f \left( \mathbf{x}_0^{i+1} \right) \right]
\end{equation*}</p>
<p>and the interpolated function $\hat{f}_0$ is integrated by applying <a class="link" href="NcmSpline.html#ncm-spline-eval-integ" title="ncm_spline_eval_integ ()"><code class="function">ncm_spline_eval_integ()</code></a>.
If any bin passes those relations then, its associated test point $\overline{\mathbf{x}}_0$ together with both knots,
are defined as a good representation of the function $f$ and this specific bin does not need to be refined anymore.
If not, then $\mathbf{x}_0 \cup \overline{\mathbf{x}}_0$ is splitted once again into two more symmetric test points around $\overline{\mathbf{x}}_0$.
A new set of knots is defined, $\mathbf{x}_1 = \mathbf{x}_0 \cup \overline{\mathbf{x}}_0$.
The ones which did not pass the tests define another set of test points $\overline{\mathbf{x}}_1$ that lie between the $\mathbf{x}_0\cup \overline{\mathbf{x}}_0$.
The new set of knots $\mathbf{x}_1$ are used to create a new interpolated function $\hat{f}_1$, always in the full range [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
].
The same tests are performed as before, but now with $\hat{f}_1(\overline{\mathbf{x}}_1)$, $f(\overline{\mathbf{x}}_1)$
and the integral now has limits $\Delta \mathbf{x}_1 = \Delta \mathbf{x}_0/2$, but only for those bins that did not pass the previous test.
Therefore, the tests are always applied on three knots at a time.
This procedure is repeated until the desired accuracy is met across the whole range [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
]. Note that it will most probably create a inhomogeneous set of knots.</p>
<img align="right" src="spline_func_knots_evolution.png" width="529"/>


The figure shows a schematically evolution of the methodology for choosing the knots.
It starts with 6 knots, $\mathbf{x}_0$ (black filled circles in the first line), used to create the interpolated function $\hat{f}_0$.
The $\overline{\mathbf{x}}_0$ test points are created (blue squares in the second line) and the first tests are performed in each one of the five bins.
In this example, only the first and the fourth bins did not pass both tests.
One new set of knots is created, $\mathbf{x}_1 = \mathbf{x}_0 \cup \overline{\mathbf{x}}_0$ (second line) and their new test points,
$\overline{\mathbf{x}}_1$ (red diamonds in the third line).
Note that $\overline{\mathbf{x}}_1$ are only placed in the middle of the previously bins that did not pass the tests.
The tests are done 4 times, one for each bin with a red diamond at it center,
with width $\Delta \mathbf{x}_1 = \Delta \mathbf{x}_0/2$. Again, only two of them passed the tests.
One new set of knots is created $\mathbf{x}_2 = \mathbf{x}_1 \cup \overline{\mathbf{x}}_1$ (third line) and their new test points,
$\overline{\mathbf{x}}_2$ (black vertical ticks in the fourth line).
The tests are done 4 times more, one for each bin with a black vertical tick at it center, with width $\Delta \mathbf{x}_2 = \Delta \mathbf{x}_1/2$.

In this schematic example, the final set of knots is given by the last line
$\mathbf{x} = \mathbf{x}_3 = \mathbf{x}_2 \cup \overline{\mathbf{x}}_2$, with 19 knots in total,
also showing that the final distribution is not homogeneous.
It is important to note that in all steps the interpolated function is created with all its knots:
$\mathbf{x}_0 \rightarrow \hat{f}_0$, $\mathbf{x}_1 \rightarrow \hat{f}_1$, $\mathbf{x}_2 \rightarrow \hat{f}_2$, $\mathbf{x}_3 \rightarrow \hat{f}_3$.
It is also worth noting that, in the description and example above, it was assumed a linear distribution of knots in each step,
but there are other options listed at <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a>.

</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.functions_details"></a><h2>Functions</h2>
<div class="refsect2">
<a name="NcmSplineFuncF"></a><h3>NcmSplineFuncF ()</h3>
<pre class="programlisting"><span class="returnvalue">gdouble</span>
<span class="c_punctuation">(</span>*NcmSplineFuncF<span class="c_punctuation">)</span> (<em class="parameter"><code><span class="type">gdouble</span> x</code></em>,
                   <em class="parameter"><code><span class="type">GObject</span> *obj</code></em>);</pre>
</div>
<hr/>
<div class="refsect2">
<a name="ncm-spline-set-func"></a><h3>ncm_spline_set_func ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
ncm_spline_set_func (<em class="parameter"><code><a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a> *s</code></em>,
                     <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a> ftype</code></em>,
                     <em class="parameter"><code><a class="link" href="numcosmo-Gir-Scanning-Compatibility.html#gsl-function" title="gsl_function"><span class="type">gsl_function</span></a> *F</code></em>,
                     <em class="parameter"><code>const <span class="type">gdouble</span> xi</code></em>,
                     <em class="parameter"><code>const <span class="type">gdouble</span> xf</code></em>,
                     <em class="parameter"><code><span class="type">gsize</span> max_nodes</code></em>,
                     <em class="parameter"><code>const <span class="type">gdouble</span> rel_error</code></em>);</pre>
<p>This function automatically determines the knots of <em class="parameter"><code>s</code></em>
 in the interval [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
] given a <em class="parameter"><code>ftype</code></em>
 and <em class="parameter"><code>rel_error</code></em>
.</p>
<p><span class="annotation">[<acronym title="Exposed in C code, not necessarily available in other languages."><span class="acronym">skip</span></acronym>]</span></p>
<div class="refsect3">
<a name="ncm-spline-set-func.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="parameters_name" width="150px"/>
<col class="parameters_description"/>
<col class="parameters_annotations" width="200px"/>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>s</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ftype</p></td>
<td class="parameter_description"><p>a <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>F</p></td>
<td class="parameter_description"><p>function to be approximated by spline functions</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xi</p></td>
<td class="parameter_description"><p>lower knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xf</p></td>
<td class="parameter_description"><p>upper knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>max_nodes</p></td>
<td class="parameter_description"><p>maximum number of knots</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>rel_error</p></td>
<td class="parameter_description"><p>relative error between the function to be interpolated and the spline result</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr/>
<div class="refsect2">
<a name="ncm-spline-set-func-scale"></a><h3>ncm_spline_set_func_scale ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
ncm_spline_set_func_scale (<em class="parameter"><code><a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a> *s</code></em>,
                           <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a> ftype</code></em>,
                           <em class="parameter"><code><a class="link" href="numcosmo-Gir-Scanning-Compatibility.html#gsl-function" title="gsl_function"><span class="type">gsl_function</span></a> *F</code></em>,
                           <em class="parameter"><code>const <span class="type">gdouble</span> xi</code></em>,
                           <em class="parameter"><code>const <span class="type">gdouble</span> xf</code></em>,
                           <em class="parameter"><code><span class="type">gsize</span> max_nodes</code></em>,
                           <em class="parameter"><code>const <span class="type">gdouble</span> rel_error</code></em>,
                           <em class="parameter"><code>const <span class="type">gdouble</span> scale</code></em>,
                           <em class="parameter"><code><span class="type">gint</span> refine</code></em>,
                           <em class="parameter"><code><span class="type">gdouble</span> refine_ns</code></em>);</pre>
<p>This function automatically determines the knots of <em class="parameter"><code>s</code></em>
 in the interval [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
] given a <em class="parameter"><code>ftype</code></em>
 and <em class="parameter"><code>rel_error</code></em>
.</p>
<p><span class="annotation">[<acronym title="Exposed in C code, not necessarily available in other languages."><span class="acronym">skip</span></acronym>]</span></p>
<div class="refsect3">
<a name="ncm-spline-set-func-scale.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="parameters_name" width="150px"/>
<col class="parameters_description"/>
<col class="parameters_annotations" width="200px"/>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>s</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ftype</p></td>
<td class="parameter_description"><p>a <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>F</p></td>
<td class="parameter_description"><p>function to be approximated by spline functions</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xi</p></td>
<td class="parameter_description"><p>lower knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xf</p></td>
<td class="parameter_description"><p>upper knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>max_nodes</p></td>
<td class="parameter_description"><p>maximum number of knots</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>rel_error</p></td>
<td class="parameter_description"><p>relative error between the function to be interpolated and the spline result</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>scale</p></td>
<td class="parameter_description"><p>scale of function, it is used to compute the absolute tolerance abstol = f_scale * rel_error</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>refine</p></td>
<td class="parameter_description"><p>if TRUE sample additional points to check if there are regions not satisfying the required tolerance</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>refine_ns</p></td>
<td class="parameter_description"><p>number of standard-deviation used to refine the grid</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr/>
<div class="refsect2">
<a name="ncm-spline-set-func1"></a><h3>ncm_spline_set_func1 ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
ncm_spline_set_func1 (<em class="parameter"><code><a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a> *s</code></em>,
                      <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a> ftype</code></em>,
                      <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncF" title="NcmSplineFuncF ()"><span class="type">NcmSplineFuncF</span></a> F</code></em>,
                      <em class="parameter"><code><span class="type">GObject</span> *obj</code></em>,
                      <em class="parameter"><code><span class="type">gdouble</span> xi</code></em>,
                      <em class="parameter"><code><span class="type">gdouble</span> xf</code></em>,
                      <em class="parameter"><code><span class="type">gsize</span> max_nodes</code></em>,
                      <em class="parameter"><code><span class="type">gdouble</span> rel_error</code></em>);</pre>
<p>This function automatically determines the knots of <em class="parameter"><code>s</code></em>
 in the interval [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
] given a <em class="parameter"><code>ftype</code></em>
 and <em class="parameter"><code>rel_error</code></em>
.</p>
<div class="refsect3">
<a name="ncm-spline-set-func1.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="parameters_name" width="150px"/>
<col class="parameters_description"/>
<col class="parameters_annotations" width="200px"/>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>s</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a>.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ftype</p></td>
<td class="parameter_description"><p>a <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>F</p></td>
<td class="parameter_description"><p>function to be approximated by spline functions. </p></td>
<td class="parameter_annotations"><span class="annotation">[<acronym title="The callback is valid only during the call to the method."><span class="acronym">scope call</span></acronym>]</span></td>
</tr>
<tr>
<td class="parameter_name"><p>obj</p></td>
<td class="parameter_description"><p><span class="type">GObject</span> used by the function <em class="parameter"><code>F</code></em>
. </p></td>
<td class="parameter_annotations"><span class="annotation">[<acronym title="NULL is OK, both for passing and for returning."><span class="acronym">allow-none</span></acronym>]</span></td>
</tr>
<tr>
<td class="parameter_name"><p>xi</p></td>
<td class="parameter_description"><p>lower knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xf</p></td>
<td class="parameter_description"><p>upper knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>max_nodes</p></td>
<td class="parameter_description"><p>maximum number of knots</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>rel_error</p></td>
<td class="parameter_description"><p>relative error between the function to be interpolated and the spline result</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr/>
<div class="refsect2">
<a name="ncm-spline-set-func-grid1"></a><h3>ncm_spline_set_func_grid1 ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
ncm_spline_set_func_grid1 (<em class="parameter"><code><a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a> *s</code></em>,
                           <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a> ftype</code></em>,
                           <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncF" title="NcmSplineFuncF ()"><span class="type">NcmSplineFuncF</span></a> F</code></em>,
                           <em class="parameter"><code><span class="type">GObject</span> *obj</code></em>,
                           <em class="parameter"><code><span class="type">gdouble</span> xi</code></em>,
                           <em class="parameter"><code><span class="type">gdouble</span> xf</code></em>,
                           <em class="parameter"><code><span class="type">gsize</span> nnodes</code></em>);</pre>
<p>This function fills the spline <em class="parameter"><code>s</code></em>
 with the function <em class="parameter"><code>F</code></em>
 values
in a uniform grid within the range [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
] and a total of <em class="parameter"><code>nnodes</code></em>
 knots.</p>
<p>The difference between <a class="link" href="numcosmo-NcmSplineFunc.html#ncm-spline-set-func-grid" title="ncm_spline_set_func_grid ()"><span class="type">ncm_spline_set_func_grid</span></a> is how the user function is passed.
Here, it uses a <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncF" title="NcmSplineFuncF ()"><span class="type">NcmSplineFuncF</span></a> function and it parameters are allocated in the object <em class="parameter"><code>obj</code></em>
.
This function is more suitable to be used within Python.</p>
<div class="refsect3">
<a name="ncm-spline-set-func-grid1.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="parameters_name" width="150px"/>
<col class="parameters_description"/>
<col class="parameters_annotations" width="200px"/>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>s</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a>.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ftype</p></td>
<td class="parameter_description"><p>a <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a>: must be either <a class="link" href="numcosmo-NcmSplineFunc.html#NCM-SPLINE-FUNC-GRID-LINEAR:CAPS"><span class="type">NCM_SPLINE_FUNC_GRID_LINEAR</span></a> or <a class="link" href="numcosmo-NcmSplineFunc.html#NCM-SPLINE-FUNC-GRID-LOG:CAPS"><span class="type">NCM_SPLINE_FUNC_GRID_LOG</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>F</p></td>
<td class="parameter_description"><p>function to be interpolated. </p></td>
<td class="parameter_annotations"><span class="annotation">[<acronym title="The callback is valid only during the call to the method."><span class="acronym">scope call</span></acronym>]</span></td>
</tr>
<tr>
<td class="parameter_name"><p>obj</p></td>
<td class="parameter_description"><p><span class="type">GObject</span> used by the function <em class="parameter"><code>F</code></em>
. </p></td>
<td class="parameter_annotations"><span class="annotation">[<acronym title="NULL is OK, both for passing and for returning."><span class="acronym">allow-none</span></acronym>]</span></td>
</tr>
<tr>
<td class="parameter_name"><p>xi</p></td>
<td class="parameter_description"><p>lower knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xf</p></td>
<td class="parameter_description"><p>upper knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>nnodes</p></td>
<td class="parameter_description"><p>number of knots including both limits knots [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
]</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr/>
<div class="refsect2">
<a name="ncm-spline-set-func-grid"></a><h3>ncm_spline_set_func_grid ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
ncm_spline_set_func_grid (<em class="parameter"><code><a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a> *s</code></em>,
                          <em class="parameter"><code><a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a> ftype</code></em>,
                          <em class="parameter"><code><a class="link" href="numcosmo-Gir-Scanning-Compatibility.html#gsl-function" title="gsl_function"><span class="type">gsl_function</span></a> *F</code></em>,
                          <em class="parameter"><code>const <span class="type">gdouble</span> xi</code></em>,
                          <em class="parameter"><code>const <span class="type">gdouble</span> xf</code></em>,
                          <em class="parameter"><code><span class="type">gsize</span> nnodes</code></em>);</pre>
<p>This function fills the spline <em class="parameter"><code>s</code></em>
 with the function <em class="parameter"><code>F</code></em>
 values
in a uniform grid within the range [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
] and a total of <em class="parameter"><code>nnodes</code></em>
 knots.</p>
<p><span class="annotation">[<acronym title="Exposed in C code, not necessarily available in other languages."><span class="acronym">skip</span></acronym>]</span></p>
<div class="refsect3">
<a name="ncm-spline-set-func-grid.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="parameters_name" width="150px"/>
<col class="parameters_description"/>
<col class="parameters_annotations" width="200px"/>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>s</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmSpline.html" title="NcmSpline"><span class="type">NcmSpline</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ftype</p></td>
<td class="parameter_description"><p>a <a class="link" href="numcosmo-NcmSplineFunc.html#NcmSplineFuncType" title="enum NcmSplineFuncType"><span class="type">NcmSplineFuncType</span></a>: must be either <a class="link" href="numcosmo-NcmSplineFunc.html#NCM-SPLINE-FUNC-GRID-LINEAR:CAPS"><span class="type">NCM_SPLINE_FUNC_GRID_LINEAR</span></a> or <a class="link" href="numcosmo-NcmSplineFunc.html#NCM-SPLINE-FUNC-GRID-LOG:CAPS"><span class="type">NCM_SPLINE_FUNC_GRID_LOG</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>F</p></td>
<td class="parameter_description"><p>function to be interpolated</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xi</p></td>
<td class="parameter_description"><p>lower knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xf</p></td>
<td class="parameter_description"><p>upper knot</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>nnodes</p></td>
<td class="parameter_description"><p>number of knots including both limits knots [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
]</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div class="refsect1">
<a name="numcosmo-NcmSplineFunc.other_details"></a><h2>Types and Values</h2>
<div class="refsect2">
<a name="NcmSplineFuncType"></a><h3>enum NcmSplineFuncType</h3>
<p>Enumeration to choose which of the functions to be applied when interpolating the input <a class="link" href="numcosmo-Gir-Scanning-Compatibility.html#gsl-function" title="gsl_function"><span class="type">gsl_function</span></a> *<em class="parameter"><code>F</code></em>
, $f$,
with the desired <em class="parameter"><code>rel_error</code></em>
 in the range [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
].
The interpolation knots, $\mathbf{x}$, are automatically defined internally by the functions.
For more details see <a class="link" href="numcosmo-NcmSplineFunc.html#numcosmo-NcmSplineFunc.description" title="Description">description</a> above.</p>
<div class="refsect3">
<a name="NcmSplineFuncType.members"></a><h4>Members</h4>
<div class="informaltable"><table border="0" class="informaltable" width="100%">
<colgroup>
<col class="enum_members_name" width="300px"/>
<col class="enum_members_description"/>
<col class="enum_members_annotations" width="200px"/>
</colgroup>
<tbody>
<tr>
<td class="enum_member_name"><p><a name="NCM-SPLINE-FUNCTION-4POINTS:CAPS"></a>NCM_SPLINE_FUNCTION_4POINTS</p></td>
<td class="enum_member_description">
<p>FIXME</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NCM-SPLINE-FUNCTION-SPLINE:CAPS"></a>NCM_SPLINE_FUNCTION_SPLINE</p></td>
<td class="enum_member_description">
<p>The knots are evenly distributed on a linear base at each step. The test points are place at $\overline{\mathbf{x}} = \frac{\mathbf{x}^{i+1} + \mathbf{x}^{i}}{2}$.</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NCM-SPLINE-FUNCTION-SPLINE-LNKNOT:CAPS"></a>NCM_SPLINE_FUNCTION_SPLINE_LNKNOT</p></td>
<td class="enum_member_description">
<p>The knots are evenly distributed on a logarithm base at each step. The test points are place at $\overline{\mathbf{x}} = \mathrm{exp}\left( \frac{\ln \mathbf{x}^{i+1} + \ln \mathbf{x}^{i}}{2}  \right)$. This method is only applied for positive intervals and is indicated for functions that changes orders of magnitude across the interval.</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NCM-SPLINE-FUNCTION-SPLINE-SINHKNOT:CAPS"></a>NCM_SPLINE_FUNCTION_SPLINE_SINHKNOT</p></td>
<td class="enum_member_description">
<p>The knots are evenly distributed on a hyperbolic sine base at each step. The test points are place at $\overline{\mathbf{x}} = \sinh \left[ \frac{\sinh^{-1} \left( \mathbf{x}^{i+1} \right) + \sinh^{-1} \left( \mathbf{x}^{i} \right)}{2} \right]$. This method is indicated for functions that changes orders of magnitude across the interval.</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NCM-SPLINE-FUNC-GRID-LINEAR:CAPS"></a>NCM_SPLINE_FUNC_GRID_LINEAR</p></td>
<td class="enum_member_description">
<p>The knots are evenly distributed on a linear base in the entire range [<em class="parameter"><code>xi</code></em>
, <em class="parameter"><code>xf</code></em>
].</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NCM-SPLINE-FUNC-GRID-LOG:CAPS"></a>NCM_SPLINE_FUNC_GRID_LOG</p></td>
<td class="enum_member_description">
<p>The knots are evenly distributed on a natural logarithmic base in the entire range [<em class="parameter"><code>xi</code></em>
 &gt; 0, <em class="parameter"><code>xf</code></em>
 &gt; xi &gt; 0].</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr/>
<div class="refsect2">
<a name="NCM-SPLINE-FUNC-DEFAULT-MAX-NODES:CAPS"></a><h3>NCM_SPLINE_FUNC_DEFAULT_MAX_NODES</h3>
<pre class="programlisting">#define NCM_SPLINE_FUNC_DEFAULT_MAX_NODES 10000000
</pre>
</div>
<hr/>
<div class="refsect2">
<a name="NCM-SPLINE-KNOT-DIFF-TOL:CAPS"></a><h3>NCM_SPLINE_KNOT_DIFF_TOL</h3>
<pre class="programlisting">#define NCM_SPLINE_KNOT_DIFF_TOL (GSL_DBL_EPSILON * 1.0e2)
</pre>
</div>
</div>
</div>
<div class="footer">
<hr/>Generated by GTK-Doc V1.34.0</div>
</body>
</html>