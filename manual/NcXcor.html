<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Cross-correlations: NumCosmo Reference Manual</title>
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot">
<link rel="home" href="index.html" title="NumCosmo Reference Manual">
<link rel="up" href="ch08s09.html" title="Cross-correlations">
<link rel="prev" href="ch08s09.html" title="Cross-correlations">
<link rel="next" href="NcXcorAB.html" title="NcXcorAB">
<meta name="generator" content="GTK-Doc V1.33.1 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="5"><tr valign="middle">
<td width="100%" align="left" class="shortcuts">
<a href="#" class="shortcut">Top</a><span id="nav_description">  <span class="dim">|</span> 
                  <a href="#NcXcor.description" class="shortcut">Description</a></span><span id="nav_hierarchy">  <span class="dim">|</span> 
                  <a href="#NcXcor.object-hierarchy" class="shortcut">Object Hierarchy</a></span><span id="nav_properties">  <span class="dim">|</span> 
                  <a href="#NcXcor.properties" class="shortcut">Properties</a></span>
</td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="16" height="16" border="0" alt="Home"></a></td>
<td><a accesskey="u" href="ch08s09.html"><img src="up.png" width="16" height="16" border="0" alt="Up"></a></td>
<td><a accesskey="p" href="ch08s09.html"><img src="left.png" width="16" height="16" border="0" alt="Prev"></a></td>
<td><a accesskey="n" href="NcXcorAB.html"><img src="right.png" width="16" height="16" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry">
<a name="NcXcor"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="NcXcor.top_of_page"></a>Cross-correlations</span></h2>
<p>Cross-correlations — Angular auto- and cross-spectra.</p>
</td>
<td class="gallery_image" valign="top" align="right"></td>
</tr></table></div>
<div class="refsect1">
<a name="NcXcor.functions"></a><h2>Functions</h2>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="functions_proto_type">
<col class="functions_proto_name">
</colgroup>
<tbody>
<tr>
<td class="function_type">
<a class="link" href="NcXcor.html" title="Cross-correlations"><span class="returnvalue">NcXcor</span></a> *
</td>
<td class="function_name">
<a class="link" href="NcXcor.html#nc-xcor-new" title="nc_xcor_new ()">nc_xcor_new</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a class="link" href="NcXcor.html" title="Cross-correlations"><span class="returnvalue">NcXcor</span></a> *
</td>
<td class="function_name">
<a class="link" href="NcXcor.html#nc-xcor-ref" title="nc_xcor_ref ()">nc_xcor_ref</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="NcXcor.html#nc-xcor-free" title="nc_xcor_free ()">nc_xcor_free</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="NcXcor.html#nc-xcor-clear" title="nc_xcor_clear ()">nc_xcor_clear</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="NcXcor.html#nc-xcor-prepare" title="nc_xcor_prepare ()">nc_xcor_prepare</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">void</span>
</td>
<td class="function_name">
<a class="link" href="NcXcor.html#nc-xcor-limber" title="nc_xcor_limber ()">nc_xcor_limber</a> <span class="c_punctuation">()</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="NcXcor.properties"></a><h2>Properties</h2>
<div class="informaltable"><table class="informaltable" border="0">
<colgroup>
<col width="150px" class="properties_type">
<col width="300px" class="properties_name">
<col width="200px" class="properties_flags">
</colgroup>
<tbody>
<tr>
<td class="property_type">
<a class="link" href="NcDistance.html" title="NcDistance"><span class="type">NcDistance</span></a> *</td>
<td class="property_name"><a class="link" href="NcXcor.html#NcXcor--distance" title="The “distance” property">distance</a></td>
<td class="property_flags">Read / Write / Construct Only</td>
</tr>
<tr>
<td class="property_type"><a class="link" href="NcXcor.html#NcXcorLimberMethod" title="enum NcXcorLimberMethod"><span class="type">NcXcorLimberMethod</span></a></td>
<td class="property_name"><a class="link" href="NcXcor.html#NcXcor--meth" title="The “meth” property">meth</a></td>
<td class="property_flags">Read / Write / Construct</td>
</tr>
<tr>
<td class="property_type">
<a class="link" href="NcmPowspec.html" title="NcmPowspec"><span class="type">NcmPowspec</span></a> *</td>
<td class="property_name"><a class="link" href="NcXcor.html#NcXcor--power-spec" title="The “power-spec” property">power-spec</a></td>
<td class="property_flags">Read / Write / Construct Only</td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="NcXcor.other"></a><h2>Types and Values</h2>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="other_proto_type">
<col class="other_proto_name">
</colgroup>
<tbody>
<tr>
<td class="datatype_keyword">enum</td>
<td class="function_name"><a class="link" href="NcXcor.html#NcXcorLimberMethod" title="enum NcXcorLimberMethod">NcXcorLimberMethod</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a class="link" href="NcXcor.html#NC-XCOR-PRECISION:CAPS" title="NC_XCOR_PRECISION">NC_XCOR_PRECISION</a></td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="NcXcor.object-hierarchy"></a><h2>Object Hierarchy</h2>
<pre class="screen">    <a href="/usr/share/gtk-doc/html/gobject/gobject-Enumeration-and-Flag-Types.html">GEnum</a>
    <span class="lineart">╰──</span> NcXcorLimberMethod
    <a href="../gobject/gobject-The-Base-Object-Type.html#GObject-struct">GObject</a>
    <span class="lineart">╰──</span> NcXcor
</pre>
</div>
<div class="refsect1">
<a name="NcXcor.description"></a><h2>Description</h2>
<p>The angular power spectrum between observables $A$ and $B$ with kernels $W^A$ and $W^B$ is
\begin{equation}
C_{\ell}^{AB} &amp;= \int dz W^A(z) \int dz^\prime W^B (z^\prime) \times \int dk \frac{2}{\pi} k^2 P(k, z, z^\prime) j_{\ell}(k\chi(z)) j_{\ell} (k\chi(z^\prime)).
\end{equation}
In the Limber approximation, it reduces to
\begin{equation}
C_{\ell}^{AB} = \int_0^{z_*} dz \frac{H(z)}{c \chi^2(z)} W^A(z) W^B (z) P\left(k = \frac{\ell +1/2}{\chi(z)} , z \right),
\end{equation}
where $P\left(k = \frac{\ell +1/2}{\chi(z)} , z \right)$ is the power spectrum (a <a class="link" href="NcmPowspec.html" title="NcmPowspec"><span class="type">NcmPowspec</span></a>) at redshift $z$ and $chi(z)$ the comoving distance (a <a class="link" href="NcDistance.html" title="NcDistance"><span class="type">NcDistance</span></a>).</p>
</div>
<div class="refsect1">
<a name="NcXcor.functions_details"></a><h2>Functions</h2>
<div class="refsect2">
<a name="nc-xcor-new"></a><h3>nc_xcor_new ()</h3>
<pre class="programlisting"><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="returnvalue">NcXcor</span></a> *
nc_xcor_new (<em class="parameter"><code><a class="link" href="NcDistance.html" title="NcDistance"><span class="type">NcDistance</span></a> *dist</code></em>,
             <em class="parameter"><code><a class="link" href="NcmPowspec.html" title="NcmPowspec"><span class="type">NcmPowspec</span></a> *ps</code></em>,
             <em class="parameter"><code><a class="link" href="NcXcor.html#NcXcorLimberMethod" title="enum NcXcorLimberMethod"><span class="type">NcXcorLimberMethod</span></a> meth</code></em>);</pre>
<p>Two methods are available to compute Limber-approximated integrals: independent GSL numerical integration or vector integration using Sundials's CVode algorithm.</p>
<div class="refsect3">
<a name="nc-xcor-new.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>dist</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcDistance.html" title="NcDistance"><span class="type">NcDistance</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>ps</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmPowspec.html" title="NcmPowspec"><span class="type">NcmPowspec</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>meth</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcor.html#NcXcorLimberMethod" title="enum NcXcorLimberMethod"><span class="type">NcXcorLimberMethod</span></a> to compute the Limber integrals</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3">
<a name="nc-xcor-new.returns"></a><h4>Returns</h4>
<p> FIXME</p>
</div>
</div>
<hr>
<div class="refsect2">
<a name="nc-xcor-ref"></a><h3>nc_xcor_ref ()</h3>
<pre class="programlisting"><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="returnvalue">NcXcor</span></a> *
nc_xcor_ref (<em class="parameter"><code><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a> *xc</code></em>);</pre>
<div class="refsect3">
<a name="nc-xcor-ref.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>xc</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
<div class="refsect3">
<a name="nc-xcor-ref.returns"></a><h4>Returns</h4>
<p><em class="parameter"><code>xc</code></em>
. </p>
<p><span class="annotation">[<acronym title="The caller owns the data, and is responsible for free it."><span class="acronym">transfer full</span></acronym>]</span></p>
</div>
</div>
<hr>
<div class="refsect2">
<a name="nc-xcor-free"></a><h3>nc_xcor_free ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
nc_xcor_free (<em class="parameter"><code><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a> *xc</code></em>);</pre>
<p>FIXME</p>
<div class="refsect3">
<a name="nc-xcor-free.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>xc</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="nc-xcor-clear"></a><h3>nc_xcor_clear ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
nc_xcor_clear (<em class="parameter"><code><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a> **xc</code></em>);</pre>
<p>FIXME</p>
<div class="refsect3">
<a name="nc-xcor-clear.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>xc</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="nc-xcor-prepare"></a><h3>nc_xcor_prepare ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
nc_xcor_prepare (<em class="parameter"><code><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a> *xc</code></em>,
                 <em class="parameter"><code><a class="link" href="NcHICosmo.html" title="NcHICosmo"><span class="type">NcHICosmo</span></a> *cosmo</code></em>);</pre>
<p>FIXME</p>
<div class="refsect3">
<a name="nc-xcor-prepare.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>xc</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>cosmo</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcHICosmo.html" title="NcHICosmo"><span class="type">NcHICosmo</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="nc-xcor-limber"></a><h3>nc_xcor_limber ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>
nc_xcor_limber (<em class="parameter"><code><a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a> *xc</code></em>,
                <em class="parameter"><code><a class="link" href="NcXcorLimberKernel.html" title="NcXcorLimberKernel"><span class="type">NcXcorLimberKernel</span></a> *xclk1</code></em>,
                <em class="parameter"><code><a class="link" href="NcXcorLimberKernel.html" title="NcXcorLimberKernel"><span class="type">NcXcorLimberKernel</span></a> *xclk2</code></em>,
                <em class="parameter"><code><a class="link" href="NcHICosmo.html" title="NcHICosmo"><span class="type">NcHICosmo</span></a> *cosmo</code></em>,
                <em class="parameter"><code><a href="../glib/glib-Basic-Types.html#guint"><span class="type">guint</span></a> lmin</code></em>,
                <em class="parameter"><code><a href="../glib/glib-Basic-Types.html#guint"><span class="type">guint</span></a> lmax</code></em>,
                <em class="parameter"><code><a class="link" href="NcmVector.html" title="NcmVector"><span class="type">NcmVector</span></a> *vp</code></em>);</pre>
<p>Performs the computation of the power spectrum $C_{\ell}^{AB}$ in the Limber approximation. The kernels of observables A and B are <em class="parameter"><code>xclk1</code></em>
 and <em class="parameter"><code>xclk2</code></em>
. If <em class="parameter"><code>xclk2</code></em>
 is NULL, the auto power spectrum is computed. The result for multipoles lmin to lmax (included) is stored in the <a class="link" href="NcmVector.html" title="NcmVector"><span class="type">NcmVector</span></a> <em class="parameter"><code>vp</code></em>
.</p>
<div class="refsect3">
<a name="nc-xcor-limber.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>xc</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcor.html" title="Cross-correlations"><span class="type">NcXcor</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xclk1</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcorLimberKernel.html" title="NcXcorLimberKernel"><span class="type">NcXcorLimberKernel</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>xclk2</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcXcorLimberKernel.html" title="NcXcorLimberKernel"><span class="type">NcXcorLimberKernel</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>cosmo</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcHICosmo.html" title="NcHICosmo"><span class="type">NcHICosmo</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>lmin</p></td>
<td class="parameter_description"><p>a <a href="../glib/glib-Basic-Types.html#guint"><span class="type">guint</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>lmax</p></td>
<td class="parameter_description"><p>a <a href="../glib/glib-Basic-Types.html#guint"><span class="type">guint</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>vp</p></td>
<td class="parameter_description"><p>a <a class="link" href="NcmVector.html" title="NcmVector"><span class="type">NcmVector</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div class="refsect1">
<a name="NcXcor.other_details"></a><h2>Types and Values</h2>
<div class="refsect2">
<a name="NcXcorLimberMethod"></a><h3>enum NcXcorLimberMethod</h3>
<p>FIXME</p>
<div class="refsect3">
<a name="NcXcorLimberMethod.members"></a><h4>Members</h4>
<div class="informaltable"><table class="informaltable" width="100%" border="0">
<colgroup>
<col width="300px" class="enum_members_name">
<col class="enum_members_description">
<col width="200px" class="enum_members_annotations">
</colgroup>
<tbody>
<tr>
<td class="enum_member_name"><p><a name="NC-XCOR-LIMBER-METHOD-GSL:CAPS"></a>NC_XCOR_LIMBER_METHOD_GSL</p></td>
<td class="enum_member_description">
<p>FIXME</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NC-XCOR-LIMBER-METHOD-CVODE:CAPS"></a>NC_XCOR_LIMBER_METHOD_CVODE</p></td>
<td class="enum_member_description">
<p>FIXME</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="NC-XCOR-LIMBER-METHOD-SUAVE:CAPS"></a>NC_XCOR_LIMBER_METHOD_SUAVE</p></td>
<td class="enum_member_description">
<p>FIXME</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2">
<a name="NC-XCOR-PRECISION:CAPS"></a><h3>NC_XCOR_PRECISION</h3>
<pre class="programlisting">#define NC_XCOR_PRECISION (1e-5)
</pre>
</div>
</div>
<div class="refsect1">
<a name="NcXcor.property-details"></a><h2>Property Details</h2>
<div class="refsect2">
<a name="NcXcor--distance"></a><h3>The <code class="literal">“distance”</code> property</h3>
<pre class="programlisting">  “distance”                 <a class="link" href="NcDistance.html" title="NcDistance"><span class="type">NcDistance</span></a> *</pre>
<p>This property keeps the distance object.</p>
<p>Owner: NcXcor</p>
<p>Flags: Read / Write / Construct Only</p>
</div>
<hr>
<div class="refsect2">
<a name="NcXcor--meth"></a><h3>The <code class="literal">“meth”</code> property</h3>
<pre class="programlisting">  “meth”                     <a class="link" href="NcXcor.html#NcXcorLimberMethod" title="enum NcXcorLimberMethod"><span class="type">NcXcorLimberMethod</span></a></pre>
<p>This property keeps the method enumerator to compute the integrals.</p>
<p>Owner: NcXcor</p>
<p>Flags: Read / Write / Construct</p>
<p>Default value: NC_XCOR_LIMBER_METHOD_GSL</p>
</div>
<hr>
<div class="refsect2">
<a name="NcXcor--power-spec"></a><h3>The <code class="literal">“power-spec”</code> property</h3>
<pre class="programlisting">  “power-spec”               <a class="link" href="NcmPowspec.html" title="NcmPowspec"><span class="type">NcmPowspec</span></a> *</pre>
<p>This property keeps the matter power spectrum object.</p>
<p>Owner: NcXcor</p>
<p>Flags: Read / Write / Construct Only</p>
</div>
</div>
</div>
<div class="footer">
<hr>Generated by GTK-Doc V1.33.1</div>
</body>
</html>